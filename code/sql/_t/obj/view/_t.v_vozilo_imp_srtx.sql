/* Table _t.vozilo_imp_srt0 */
TRUNCATE TABLE _t.vozilo_imp_srt0 CASCADE;
COMMIT;
INSERT INTO _t.vozilo_imp_srt0
SELECT ROW_NUMBER() OVER (ORDER BY i.mr_naziv, i.md_naziv_k, i.mdt_oznaka, i.mdvr_oznaka, i.mdvz_oznaka, i.mt_oznaka, i.mt_cm3, i.mt_kw)+100000 AS vzs_id,
       TO_CHAR(ROW_NUMBER() OVER (ORDER BY i.mr_naziv, i.md_naziv_k, i.mdt_oznaka, i.mdvr_oznaka, i.mdvz_oznaka, i.mt_oznaka, i.mt_cm3, i.mt_kw)+100000, 'fm000000') AS vzs_oznaka,
       COUNT(*) AS vz_cnt,
       ARRAY_AGG(i.vz_sasija) AS vz_sasije,
       i.vzpv_naziv,
       i.vzk_naziv,
       i.mr_naziv,
       i.md_naziv_k,
       i.mdt_oznaka,
       i.mdvr_oznaka,
       i.mdvz_oznaka,
       i.vz_duzina,
       i.vz_sirina,
       i.vz_visina,
       i.vz_masa,
       i.vz_masa_max,
       i.vz_nosivost,
       i.vzo_nosivost1,
       i.vzo_nosivost2,
       i.vzo_nosivost3,
       i.vzo_nosivost4,
       i.vzo_pneumatik1,
       i.vzo_pneumatik2,
       i.vzo_pneumatik3,
       i.vzo_pneumatik4,
       i.vz_br_osovina,
       i.vz_br_tockova,
       i.mt_oznaka,
       i.mt_cm3,
       i.mt_kw,
       i.gr_naziv,
       NULLIF(i.gr_gas, '#') AS gr_gas,
       i.vz_kw_kg,
       i.vz_mesta_sedenje,
       i.vz_mesta_stajanje,
       i.vz_kmh,
       i.vz_godina,
       i.em_naziv,
       i.vz_co2
  FROM _t.v_vozilo_imp i
  GROUP BY i.vzpv_naziv,
           i.vzk_naziv,
           i.mr_naziv,
           i.md_naziv_k,
           i.mdt_oznaka,
           i.mdvr_oznaka,
           i.mdvz_oznaka,
           i.vz_duzina,
           i.vz_sirina,
           i.vz_visina,
           i.vz_masa,
           i.vz_masa_max,
           i.vz_nosivost,
           i.vzo_nosivost1,
           i.vzo_nosivost2,
           i.vzo_nosivost3,
           i.vzo_nosivost4,
           i.vzo_pneumatik1,
           i.vzo_pneumatik2,
           i.vzo_pneumatik3,
           i.vzo_pneumatik4,
           i.vz_br_osovina,
           i.vz_br_tockova,
           i.mt_oznaka,
           i.mt_cm3,
           i.mt_kw,
           i.gr_naziv,
           NULLIF(i.gr_gas, '#'),
           i.vz_kw_kg,
           i.vz_mesta_sedenje,
           i.vz_mesta_stajanje,
           i.vz_kmh,
           i.vz_godina,
           i.em_naziv,
           i.vz_co2;

/* Table _t.vozilo_imp_srt1 */
TRUNCATE TABLE _t.vozilo_imp_srt1 CASCADE;
COMMIT;
INSERT INTO _t.vozilo_imp_srt1
SELECT ROW_NUMBER() OVER (ORDER BY i.mr_naziv, i.md_naziv_k, i.mdt_oznaka, i.mdvr_oznaka, i.mdvz_oznaka, i.mt_oznaka, i.mt_cm3, i.mt_kw)+100000 AS vzs_id,
       TO_CHAR(ROW_NUMBER() OVER (ORDER BY i.mr_naziv, i.md_naziv_k, i.mdt_oznaka, i.mdvr_oznaka, i.mdvz_oznaka, i.mt_oznaka, i.mt_cm3, i.mt_kw)+100000, 'fm000000') AS vzs_oznaka,
       COUNT(*) AS vz_cnt,
       ARRAY_AGG(i.vz_sasija) AS vz_sasije,
       i.vzpv_naziv,
       i.vzk_naziv,
       i.mr_naziv,
       i.md_naziv_k,
       i.mdt_oznaka,
       i.mdvr_oznaka,
       i.mdvz_oznaka,
       i.vz_duzina,
       i.vz_sirina,
       i.vz_visina,
       i.vz_masa,
       i.vz_masa_max,
       i.vz_nosivost,
       i.vzo_nosivost1,
       i.vzo_nosivost2,
       i.vzo_nosivost3,
       i.vzo_nosivost4,
       ARRAY_AGG(DISTINCT i.vzo_pneumatik1) AS vzo_pneumatik1,
       ARRAY_AGG(DISTINCT i.vzo_pneumatik2) AS vzo_pneumatik2,
       ARRAY_AGG(DISTINCT i.vzo_pneumatik3) AS vzo_pneumatik3,
       ARRAY_AGG(DISTINCT i.vzo_pneumatik4) AS vzo_pneumatik4,
       i.vz_br_osovina,
       i.vz_br_tockova,
       i.mt_oznaka,
       i.mt_cm3,
       i.mt_kw,
       i.gr_naziv,
       NULLIF(i.gr_gas, '#') AS gr_gas,
       i.vz_kw_kg,
       i.vz_mesta_sedenje,
       i.vz_mesta_stajanje,
       i.vz_kmh,
       ARRAY_AGG(DISTINCT i.vz_godina) AS vz_godina,
       i.em_naziv,
       i.vz_co2
  FROM _t.v_vozilo_imp i
  GROUP BY i.vzpv_naziv,
           i.vzk_naziv,
           i.mr_naziv,
           i.md_naziv_k,
           i.mdt_oznaka,
           i.mdvr_oznaka,
           i.mdvz_oznaka,
           i.vz_duzina,
           i.vz_sirina,
           i.vz_visina,
           i.vz_masa,
           i.vz_masa_max,
           i.vz_nosivost,
           i.vzo_nosivost1,
           i.vzo_nosivost2,
           i.vzo_nosivost3,
           i.vzo_nosivost4,
           i.vz_br_osovina,
           i.vz_br_tockova,
           i.mt_oznaka,
           i.mt_cm3,
           i.mt_kw,
           i.gr_naziv,
           NULLIF(i.gr_gas, '#'),
           i.vz_kw_kg,
           i.vz_mesta_sedenje,
           i.vz_mesta_stajanje,
           i.vz_kmh,
           i.em_naziv,
           i.vz_co2;

/* Table _t.vozilo_imp_srt2 */
TRUNCATE TABLE _t.vozilo_imp_srt2 CASCADE;
COMMIT;
INSERT INTO _t.vozilo_imp_srt2
SELECT ROW_NUMBER() OVER (ORDER BY i.mr_naziv, i.mdt_oznaka, i.mdvr_oznaka, i.mdvz_oznaka, i.mt_oznaka, i.mt_cm3, i.mt_kw)+100000 AS vzs_id,
       TO_CHAR(ROW_NUMBER() OVER (ORDER BY i.mr_naziv, i.mdt_oznaka, i.mdvr_oznaka, i.mdvz_oznaka, i.mt_oznaka, i.mt_cm3, i.mt_kw)+100000, 'fm000000') AS vzs_oznaka,
       COUNT(*) AS vz_cnt,
       ARRAY_AGG(i.vz_sasija) AS vz_sasije,
       i.vzpv_naziv,
       i.vzk_naziv,
       i.mr_naziv,
       MIN(i.md_naziv_k) AS md_naziv_k,
       ARRAY_AGG(DISTINCT i.md_naziv_k) AS md_naziv_k_a,
       i.mdt_oznaka,
       i.mdvr_oznaka,
       i.mdvz_oznaka,
       i.vz_duzina,
       i.vz_sirina,
       i.vz_visina,
       i.vz_masa,
       i.vz_masa_max,
       i.vz_nosivost,
       i.vzo_nosivost1,
       i.vzo_nosivost2,
       i.vzo_nosivost3,
       i.vzo_nosivost4,
       ARRAY_AGG(DISTINCT i.vzo_pneumatik1) AS vzo_pneumatik1,
       ARRAY_AGG(DISTINCT i.vzo_pneumatik2) AS vzo_pneumatik2,
       ARRAY_AGG(DISTINCT i.vzo_pneumatik3) AS vzo_pneumatik3,
       ARRAY_AGG(DISTINCT i.vzo_pneumatik4) AS vzo_pneumatik4,
       i.vz_br_osovina,
       i.vz_br_tockova,
       i.mt_oznaka,
       i.mt_cm3,
       i.mt_kw,
       i.gr_naziv,
       NULLIF(i.gr_gas, '#') AS gr_gas,
       i.vz_kw_kg,
       i.vz_mesta_sedenje,
       i.vz_mesta_stajanje,
       i.vz_kmh,
       ARRAY_AGG(DISTINCT i.vz_godina) AS vz_godina,
       i.em_naziv,
       MIN(i.vz_co2) AS vz_co2,
       ARRAY_AGG(DISTINCT i.vz_co2) AS vz_co2_a
  FROM _t.v_vozilo_imp i
  GROUP BY i.vzpv_naziv,
           i.vzk_naziv,
           i.mr_naziv,
           i.mdt_oznaka,
           i.mdvr_oznaka,
           i.mdvz_oznaka,
           i.vz_duzina,
           i.vz_sirina,
           i.vz_visina,
           i.vz_masa,
           i.vz_masa_max,
           i.vz_nosivost,
           i.vzo_nosivost1,
           i.vzo_nosivost2,
           i.vzo_nosivost3,
           i.vzo_nosivost4,
           i.vz_br_osovina,
           i.vz_br_tockova,
           i.mt_oznaka,
           i.mt_cm3,
           i.mt_kw,
           i.gr_naziv,
           NULLIF(i.gr_gas, '#'),
           i.vz_kw_kg,
           i.vz_mesta_sedenje,
           i.vz_mesta_stajanje,
           i.vz_kmh,
           i.em_naziv;
